# =============================================================================
# Docker Environment Variables
# =============================================================================
#
# Copy this file:
#   cp .env.docker.example .env.docker
#
# Generate required secrets:
#   APP_KEY:      echo "base64:$(openssl rand -base64 32)"
#   DB_PASSWORD:  openssl rand -base64 32
#
# Run with:
#   docker compose --env-file .env.docker up -d                    # Development
#   docker compose --env-file .env.docker -f docker-compose.yml -f docker-compose.prod.yml up -d  # Production
#
# =============================================================================

# -----------------------------------------------------------------------------
# Application (REQUIRED)
# -----------------------------------------------------------------------------
APP_NAME="Video Editor"
APP_ENV=production
APP_DEBUG=false
APP_URL=https://your-domain.com

# Generate with: echo "base64:$(openssl rand -base64 32)"
APP_KEY=base64:CHANGE_ME_GENERATE_A_REAL_KEY

# -----------------------------------------------------------------------------
# Database - PostgreSQL (REQUIRED)
# -----------------------------------------------------------------------------
DB_CONNECTION=pgsql
DB_HOST=postgres
DB_PORT=5432
DB_DATABASE=videoeditor
DB_USERNAME=videoeditor

# Generate with: openssl rand -base64 32
DB_PASSWORD=CHANGE_ME_GENERATE_A_REAL_PASSWORD

# External port for local access (not used in production)
# DB_EXTERNAL_PORT=5432

# -----------------------------------------------------------------------------
# Redis (REQUIRED for queue/cache)
# -----------------------------------------------------------------------------
REDIS_HOST=redis
REDIS_PORT=6379
# Optional: set a password for Redis
REDIS_PASSWORD=

# External port for local access (not used in production)
# REDIS_EXTERNAL_PORT=6379

# -----------------------------------------------------------------------------
# External Services (REQUIRED)
# -----------------------------------------------------------------------------
# Get from: https://fal.ai/dashboard/keys
FAL_KEY=your-fal-api-key-here

# -----------------------------------------------------------------------------
# Cloudflare R2 Storage (Production)
# -----------------------------------------------------------------------------
FILESYSTEM_DISK=s3
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=auto
AWS_BUCKET=usepresence
AWS_ENDPOINT=https://2e030e810bc7cb3df9cb0e0a7997d8b9.r2.cloudflarestorage.com
AWS_USE_PATH_STYLE_ENDPOINT=false

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
LOG_CHANNEL=stderr
LOG_LEVEL=info

# -----------------------------------------------------------------------------
# Cache & Session
# -----------------------------------------------------------------------------
CACHE_STORE=redis
SESSION_DRIVER=redis

# IMPORTANT: Set to true when using HTTPS (required for reverse proxies like Coolify)
SESSION_SECURE_COOKIE=true
SESSION_SAME_SITE=lax

# -----------------------------------------------------------------------------
# Queue Configuration (optimized for video processing)
# -----------------------------------------------------------------------------
QUEUE_CONNECTION=redis

# Queue names to process (comma-separated)
QUEUE_NAME=default,renders,generations

# Job timeout in seconds (15 min for video rendering)
QUEUE_TIMEOUT=900

# Number of retry attempts
QUEUE_TRIES=3

# Max jobs before worker restarts (lower = more memory cleanup)
QUEUE_MAX_JOBS=100

# Memory limit in MB (2GB for FFmpeg)
QUEUE_MEMORY=2048

# Number of queue worker replicas (production only)
QUEUE_WORKERS=3

# -----------------------------------------------------------------------------
# Container Settings
# -----------------------------------------------------------------------------
# Container mode: app | queue | scheduler | horizon
# (Set per-service in docker-compose, not here)
# CONTAINER_MODE=app

# Auto-run migrations on container start
# WARNING: Set to true only for initial deploy, then set to false
AUTO_MIGRATE=false

# -----------------------------------------------------------------------------
# Docker Registry (optional)
# -----------------------------------------------------------------------------
# Leave empty for local builds
REGISTRY=
IMAGE_TAG=latest

# -----------------------------------------------------------------------------
# PHP Settings (App Server)
# -----------------------------------------------------------------------------
PHP_MEMORY_LIMIT=512M
PHP_MAX_EXECUTION_TIME=120
PHP_UPLOAD_MAX_FILESIZE=500M
PHP_POST_MAX_SIZE=500M

# -----------------------------------------------------------------------------
# PHP Settings (Queue Workers) - set in docker-compose.prod.yml
# These are higher for video/FFmpeg processing:
# PHP_MEMORY_LIMIT=2G
# PHP_MAX_EXECUTION_TIME=0 (unlimited)
# PHP_UPLOAD_MAX_FILESIZE=2G
# PHP_POST_MAX_SIZE=2G
# -----------------------------------------------------------------------------

# -----------------------------------------------------------------------------
# Ports (Local Development Only)
# -----------------------------------------------------------------------------
APP_PORT=8000
# DB_EXTERNAL_PORT=5432
# REDIS_EXTERNAL_PORT=6379
